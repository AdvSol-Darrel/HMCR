-- =============================================
-- Author:		Ben Driver
-- Create date: 2020-02-11
-- Updates: 
--	
-- 
-- Description:	Incremnetal DML in support of sprint 5.
--  - Drop duplicate rows in HMR_SUBMISSION_STATUS
--  - Revise CODE_LOOKUP values for 0 volume and Direction indicator
--  - Insert and update STREAM_ELEMENT records populating extended attributes
--  - Add long description to SUBMISSION_STATUS records 
--  - Replace UOM site/num with site
--
-- =============================================

USE HMR_DEV; -- uncomment appropriate instance
--USE HMR_TST;
--USE HMR_UAT;
--USE HMR_PRD;
GO

/* ---------------------------------------------------------------------- */
/* Delete duplicate HMR_SUBMISSION_STATUS records                                                 */
/* ---------------------------------------------------------------------- */


DELETE FROM [dbo].[HMR_SUBMISSION_STATUS]
      WHERE [STATUS_ID] > 10
GO


/* ---------------------------------------------------------------------- */
/* Revise VOLUME_RANGE1 code lookup records                                                 */
/* ---------------------------------------------------------------------- */


DELETE FROM [dbo].[HMR_CODE_LOOKUP] WHERE CODE_SET = 'VOLUME_RANGE1';
GO

INSERT INTO HMR_CODE_LOOKUP (CODE_SET, CODE_NAME, CODE_VALUE_TEXT, CODE_VALUE_NUM, DISPLAY_ORDER, CODE_VALUE_FORMAT) VALUES ('VOLUME_RANGE1', '0', '0',NULL, '1', 'STRING');
GO
INSERT INTO HMR_CODE_LOOKUP (CODE_SET, CODE_NAME, CODE_VALUE_TEXT, CODE_VALUE_NUM, DISPLAY_ORDER, CODE_VALUE_FORMAT) VALUES ('VOLUME_RANGE1', '< 0.03 m3', '< 0.03 m3',NULL, '2', 'STRING');
GO
INSERT INTO HMR_CODE_LOOKUP (CODE_SET, CODE_NAME, CODE_VALUE_TEXT, CODE_VALUE_NUM, DISPLAY_ORDER, CODE_VALUE_FORMAT) VALUES ('VOLUME_RANGE1', '0.03 m3 to 0.1 m3', '0.03 m3 to 0.1 m3',NULL, '3', 'STRING');
GO
INSERT INTO HMR_CODE_LOOKUP (CODE_SET, CODE_NAME, CODE_VALUE_TEXT, CODE_VALUE_NUM, DISPLAY_ORDER, CODE_VALUE_FORMAT) VALUES ('VOLUME_RANGE1', '0.1 m3 to 0.3 m3', '0.1 m3 to 0.3 m3',NULL, '4', 'STRING');
GO
INSERT INTO HMR_CODE_LOOKUP (CODE_SET, CODE_NAME, CODE_VALUE_TEXT, CODE_VALUE_NUM, DISPLAY_ORDER, CODE_VALUE_FORMAT) VALUES ('VOLUME_RANGE1', '0.3 m3 to 0.5 m3', '0.3 m3 to 0.5 m3',NULL, '5', 'STRING');
GO
INSERT INTO HMR_CODE_LOOKUP (CODE_SET, CODE_NAME, CODE_VALUE_TEXT, CODE_VALUE_NUM, DISPLAY_ORDER, CODE_VALUE_FORMAT) VALUES ('VOLUME_RANGE1', '0.5 m3 to 1.0 m3', '0.5 m3 to 1.0 m3',NULL, '6', 'STRING');
GO
INSERT INTO HMR_CODE_LOOKUP (CODE_SET, CODE_NAME, CODE_VALUE_TEXT, CODE_VALUE_NUM, DISPLAY_ORDER, CODE_VALUE_FORMAT) VALUES ('VOLUME_RANGE1', '1.0 m3 to 5.0 m3', '1.0 m3 to 5.0 m3',NULL, '7', 'STRING');
GO
INSERT INTO HMR_CODE_LOOKUP (CODE_SET, CODE_NAME, CODE_VALUE_TEXT, CODE_VALUE_NUM, DISPLAY_ORDER, CODE_VALUE_FORMAT) VALUES ('VOLUME_RANGE1', '>5.0 m3 ', '>5.0 m3',NULL, '8', 'STRING');
GO

/* ---------------------------------------------------------------------- */
/* Insert RKFL_RPT_RECORD_TYPE code lookup records                        */
/* ---------------------------------------------------------------------- */

DELETE FROM [dbo].[HMR_CODE_LOOKUP] WHERE CODE_SET = 'RKFL_RPT_RECORD_TYPE';
GO

INSERT INTO HMR_CODE_LOOKUP (CODE_SET, CODE_NAME, CODE_VALUE_TEXT, CODE_VALUE_NUM, DISPLAY_ORDER, CODE_VALUE_FORMAT) VALUES ('RKFL_RPT_RECORD_TYPE', 'Rockfall Incident', 'F',NULL, NULL, 'STRING');
GO

/* ---------------------------------------------------------------------- */
/* Insert DIRECTION code lookup records                        	          */
/* ---------------------------------------------------------------------- */

DELETE FROM [dbo].[HMR_CODE_LOOKUP] WHERE CODE_SET = 'DIRECTION';
GO

INSERT INTO HMR_CODE_LOOKUP (CODE_SET, CODE_NAME, CODE_VALUE_TEXT, CODE_VALUE_NUM, DISPLAY_ORDER, CODE_VALUE_FORMAT) VALUES ('DIRECTION', 'North', 'N',NULL, NULL, 'STRING');
GO
INSERT INTO HMR_CODE_LOOKUP (CODE_SET, CODE_NAME, CODE_VALUE_TEXT, CODE_VALUE_NUM, DISPLAY_ORDER, CODE_VALUE_FORMAT) VALUES ('DIRECTION', 'East', 'E',NULL, NULL, 'STRING');
GO
INSERT INTO HMR_CODE_LOOKUP (CODE_SET, CODE_NAME, CODE_VALUE_TEXT, CODE_VALUE_NUM, DISPLAY_ORDER, CODE_VALUE_FORMAT) VALUES ('DIRECTION', 'South', 'S',NULL, NULL, 'STRING');
GO
INSERT INTO HMR_CODE_LOOKUP (CODE_SET, CODE_NAME, CODE_VALUE_TEXT, CODE_VALUE_NUM, DISPLAY_ORDER, CODE_VALUE_FORMAT) VALUES ('DIRECTION', 'West', 'W',NULL, NULL, 'STRING');
GO

/* ---------------------------------------------------------------------- */
/* Delete CODE_LOOKUP records                        	      */
/* ---------------------------------------------------------------------- */

DELETE FROM [dbo].[HMR_CODE_LOOKUP]
      WHERE [CODE_VALUE_TEXT] = 'site/num'
GO

/* ---------------------------------------------------------------------- */
/* Insert and update STREAM_ELEMENT records                        	      */
/* ---------------------------------------------------------------------- */

/* Load user context variables.  Redeclared for subsequent executions */

DECLARE @utcdate DATETIME = (SELECT getutcdate() AS utcdate)
DECLARE @app_guid UNIQUEIDENTIFIER = (SELECT CASE WHEN SUSER_SID() IS NOT NULL THEN SUSER_SID() ELSE (SELECT CONVERT(uniqueidentifier,STUFF(STUFF(STUFF(STUFF('B00D00A0AC0A0D0C00DD00F0D0C00000',9,0,'-'),14,0,'-'),19,0,'-'),24,0,'-'))) END AS  app_guid)
DECLARE @app_user VARCHAR(30) = (SELECT CASE WHEN SUBSTRING(SUSER_NAME(),CHARINDEX('\',SUSER_NAME())+1,LEN(SUSER_NAME())) IS NOT NULL THEN SUBSTRING(SUSER_NAME(),CHARINDEX('\',SUSER_NAME())+1,LEN(SUSER_NAME())) ELSE CURRENT_USER END AS app_user)
DECLARE @app_user_dir VARCHAR(12) = (SELECT CASE WHEN LEN(SUBSTRING(SUSER_NAME(),0,CHARINDEX('\',SUSER_NAME(),0)))>1 THEN SUBSTRING(SUSER_NAME(),0,CHARINDEX('\',SUSER_NAME(),0)) ELSE 'WIN AUTH' END AS app_user_dir)

INSERT INTO HMR_STREAM_ELEMENT (SUBMISSION_STREAM_ID,STAGING_COLUMN_NAME,ELEMENT_NAME,CODE_SET,ELEMENT_TYPE,IS_REQUIRED,MAX_LENGTH,MIN_LENGTH,APP_CREATE_USERID,APP_CREATE_TIMESTAMP,APP_CREATE_USER_GUID,APP_CREATE_USER_DIRECTORY,APP_LAST_UPDATE_USERID,APP_LAST_UPDATE_TIMESTAMP,APP_LAST_UPDATE_USER_GUID,APP_LAST_UPDATE_USER_DIRECTORY) VALUES ((SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting'), 'RECORD_TYPE','RECORD TYPE','String', 'RKFL_RPT_RECORD_TYPE',1,1,1,@app_user,@utcdate,@app_guid,@app_user_dir,@app_user,@utcdate,@app_guid,@app_user_dir);

INSERT INTO HMR_STREAM_ELEMENT (SUBMISSION_STREAM_ID,STAGING_COLUMN_NAME,ELEMENT_NAME,CODE_SET,ELEMENT_TYPE,IS_REQUIRED,MAX_LENGTH,MIN_LENGTH,APP_CREATE_USERID,APP_CREATE_TIMESTAMP,APP_CREATE_USER_GUID,APP_CREATE_USER_DIRECTORY,APP_LAST_UPDATE_USERID,APP_LAST_UPDATE_TIMESTAMP,APP_LAST_UPDATE_USER_GUID,APP_LAST_UPDATE_USER_DIRECTORY) VALUES ((SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting'), 'SERVICE_AREA','SERVICE AREA','Numeric', NULL,1,2,1,@app_user,@utcdate,@app_guid,@app_user_dir,@app_user,@utcdate,@app_guid,@app_user_dir);

INSERT INTO HMR_STREAM_ELEMENT (SUBMISSION_STREAM_ID,STAGING_COLUMN_NAME,ELEMENT_NAME,CODE_SET,ELEMENT_TYPE,IS_REQUIRED,MAX_LENGTH,MIN_LENGTH,APP_CREATE_USERID,APP_CREATE_TIMESTAMP,APP_CREATE_USER_GUID,APP_CREATE_USER_DIRECTORY,APP_LAST_UPDATE_USERID,APP_LAST_UPDATE_TIMESTAMP,APP_LAST_UPDATE_USER_GUID,APP_LAST_UPDATE_USER_DIRECTORY) VALUES ((SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting'), 'OTHER_DITCH_VOLUME','OTHER DITCH VOLUME','Numeric', NULL,0,6,3,@app_user,@utcdate,@app_guid,@app_user_dir,@app_user,@utcdate,@app_guid,@app_user_dir);

INSERT INTO HMR_STREAM_ELEMENT (SUBMISSION_STREAM_ID,STAGING_COLUMN_NAME,ELEMENT_NAME,CODE_SET,ELEMENT_TYPE,IS_REQUIRED,MAX_LENGTH,MIN_LENGTH,APP_CREATE_USERID,APP_CREATE_TIMESTAMP,APP_CREATE_USER_GUID,APP_CREATE_USER_DIRECTORY,APP_LAST_UPDATE_USERID,APP_LAST_UPDATE_TIMESTAMP,APP_LAST_UPDATE_USER_GUID,APP_LAST_UPDATE_USER_DIRECTORY) VALUES ((SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting'), 'OTHER_TRAVELLED_LANES_VOLUME','OTHER TRAVELLED LANES VOLUME','Numeric', NULL,0,6,3,@app_user,@utcdate,@app_guid,@app_user_dir,@app_user,@utcdate,@app_guid,@app_user_dir);

UPDATE [dbo].[HMR_STREAM_ELEMENT] SET CODE_SET='DIRECTION',CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'DIRECTION_FROM_LANDMARK';

UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=1,MIN_LENGTH=1,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Wildlife Reporting') AND STAGING_COLUMN_NAME = 'RECORD_TYPE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=2,MIN_LENGTH=1,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Wildlife Reporting') AND STAGING_COLUMN_NAME = 'SERVICE_AREA';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=10,MIN_LENGTH=8,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Wildlife Reporting') AND STAGING_COLUMN_NAME = 'ACCIDENT_DATE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=1,MIN_LENGTH=1,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Wildlife Reporting') AND STAGING_COLUMN_NAME = 'TIME_OF_KILL';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=NULL,MIN_LENGTH=NULL,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Wildlife Reporting') AND STAGING_COLUMN_NAME = 'LATITUDE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=NULL,MIN_LENGTH=NULL,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Wildlife Reporting') AND STAGING_COLUMN_NAME = 'LONGITUDE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=16,MIN_LENGTH=16,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Wildlife Reporting') AND STAGING_COLUMN_NAME = 'HIGHWAY_UNIQUE_NUMBER';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=8,MIN_LENGTH=8,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Wildlife Reporting') AND STAGING_COLUMN_NAME = 'LANDMARK';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=6,MIN_LENGTH=0,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Wildlife Reporting') AND STAGING_COLUMN_NAME = 'START_OFFSET';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=150,MIN_LENGTH=150,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Wildlife Reporting') AND STAGING_COLUMN_NAME = 'NEAREST_TOWN';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=1,MIN_LENGTH=1,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Wildlife Reporting') AND STAGING_COLUMN_NAME = 'WILDLIFE_SIGN';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=2,MIN_LENGTH=1,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Wildlife Reporting') AND STAGING_COLUMN_NAME = 'QUANTITY';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=2,MIN_LENGTH=NULL,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Wildlife Reporting') AND STAGING_COLUMN_NAME = 'SPECIES';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=1,MIN_LENGTH=1,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Wildlife Reporting') AND STAGING_COLUMN_NAME = 'SEX';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=1,MIN_LENGTH=1,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Wildlife Reporting') AND STAGING_COLUMN_NAME = 'AGE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=1024,MIN_LENGTH=1024,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Wildlife Reporting') AND STAGING_COLUMN_NAME = 'COMMENT';

UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=12,MIN_LENGTH=12,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'MCRR_INCIDENT_NUMBER';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=1,MIN_LENGTH=1,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'RECORD_TYPE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=2,MIN_LENGTH=1,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'SERVICE_AREA';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=10,MIN_LENGTH=8,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'ESTIMATED_ROCKFALL_DATE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=8,MIN_LENGTH=4,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'ESTIMATED_ROCKFALL_TIME';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=NULL,MIN_LENGTH=NULL,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'START_LATITUDE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=NULL,MIN_LENGTH=NULL,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'START_LONGITUDE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=NULL,MIN_LENGTH=NULL,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'END_LATITUDE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=NULL,MIN_LENGTH=NULL,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'END_LONGITUDE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=16,MIN_LENGTH=16,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'HIGHWAY_UNIQUE_NUMBER';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=255,MIN_LENGTH=255,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'HIGHWAY_UNIQUE_NAME';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=8,MIN_LENGTH=8,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'LANDMARK';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=255,MIN_LENGTH=255,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'LAND_MARK_NAME';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=6,MIN_LENGTH=0,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'START_OFFSET';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=6,MIN_LENGTH=0,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'END_OFFSET';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=1,MIN_LENGTH=1,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'DIRECTION_FROM_LANDMARK';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=4000,MIN_LENGTH=0,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'LOCATION_DESCRIPTION';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=30,MIN_LENGTH=30,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'DITCH_VOLUME';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=30,MIN_LENGTH=30,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'TRAVELLED_LANES_VOLUME';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=6,MIN_LENGTH=3,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'OTHER_DITCH_VOLUME';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=6,MIN_LENGTH=3,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'OTHER_TRAVELLED_LANES_VOLUME';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=1,MIN_LENGTH=1,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'HEAVY_PRECIP';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=1,MIN_LENGTH=1,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'FREEZE_THAW';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=1,MIN_LENGTH=1,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'DITCH_SNOW_ICE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=1,MIN_LENGTH=1,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'VEHICLE_DAMAGE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=4000,MIN_LENGTH=0,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'COMMENTS';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=150,MIN_LENGTH=2,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'REPORTER_NAME';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=12,MIN_LENGTH=12,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'MC_PHONE_NUMBER';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=10,MIN_LENGTH=8,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'Rockfall Reporting') AND STAGING_COLUMN_NAME = 'REPORT_DATE';

UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=1,MIN_LENGTH=1,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'MC Work Reporting') AND STAGING_COLUMN_NAME = 'RECORD_TYPE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=2,MIN_LENGTH=1,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'MC Work Reporting') AND STAGING_COLUMN_NAME = 'SERVICE_AREA';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=12,MIN_LENGTH=12,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'MC Work Reporting') AND STAGING_COLUMN_NAME = 'RECORD_NUMBER';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=12,MIN_LENGTH=0,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'MC Work Reporting') AND STAGING_COLUMN_NAME = 'TASK_NUMBER';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=6,MIN_LENGTH=6,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'MC Work Reporting') AND STAGING_COLUMN_NAME = 'ACTIVITY_NUMBER';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=NULL,MIN_LENGTH=NULL,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'MC Work Reporting') AND STAGING_COLUMN_NAME = 'START_DATE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=NULL,MIN_LENGTH=NULL,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'MC Work Reporting') AND STAGING_COLUMN_NAME = 'END_DATE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=9,MIN_LENGTH=1,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'MC Work Reporting') AND STAGING_COLUMN_NAME = 'ACCOMPLISHMENT';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=12,MIN_LENGTH=12,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'MC Work Reporting') AND STAGING_COLUMN_NAME = 'UNIT_OF_MEASURE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=1,MAX_LENGTH=NULL,MIN_LENGTH=NULL,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'MC Work Reporting') AND STAGING_COLUMN_NAME = 'POSTED_DATE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=16,MIN_LENGTH=16,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'MC Work Reporting') AND STAGING_COLUMN_NAME = 'HIGHWAY_UNIQUE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=8,MIN_LENGTH=8,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'MC Work Reporting') AND STAGING_COLUMN_NAME = 'LANDMARK';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=NULL,MIN_LENGTH=NULL,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'MC Work Reporting') AND STAGING_COLUMN_NAME = 'START_OFFSET';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=NULL,MIN_LENGTH=NULL,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'MC Work Reporting') AND STAGING_COLUMN_NAME = 'END_OFFSET';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=NULL,MIN_LENGTH=NULL,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'MC Work Reporting') AND STAGING_COLUMN_NAME = 'START_LATITUDE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=NULL,MIN_LENGTH=NULL,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'MC Work Reporting') AND STAGING_COLUMN_NAME = 'START_LONGITUDE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=NULL,MIN_LENGTH=NULL,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'MC Work Reporting') AND STAGING_COLUMN_NAME = 'END_LATITUDE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=NULL,MIN_LENGTH=NULL,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'MC Work Reporting') AND STAGING_COLUMN_NAME = 'END_LONGITUDE';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=5,MIN_LENGTH=5,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'MC Work Reporting') AND STAGING_COLUMN_NAME = 'STRUCTURE_NUMBER';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=8,MIN_LENGTH=0,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'MC Work Reporting') AND STAGING_COLUMN_NAME = 'SITE_NUMBER';
UPDATE [dbo].[HMR_STREAM_ELEMENT] SET IS_REQUIRED=0,MAX_LENGTH=9,MIN_LENGTH=0,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir WHERE SUBMISSION_STREAM_ID = (SELECT SUBMISSION_STREAM_ID FROM HMR_SUBMISSION_STREAM WHERE STREAM_NAME = 'MC Work Reporting') AND STAGING_COLUMN_NAME = 'VALUE_OF_WORK ';



/* ---------------------------------------------------------------------- */
/* Update SUBMISSION_STATUS records                        	              */
/* ---------------------------------------------------------------------- */

UPDATE [dbo].[HMR_SUBMISSION_STATUS] SET LONG_DESCRIPTION = 'Indicates that the submitted file was uploaded in acceptable format, falls within expected file size, and is structured properly corresponding to the selected report type.  Further validation processing can proceed.' ,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID = @app_user,APP_LAST_UPDATE_TIMESTAMP = @utcdate,APP_LAST_UPDATE_USER_GUID = @app_guid,APP_LAST_UPDATE_USER_DIRECTORY = @app_user_dir WHERE STATUS_CODE = 'FR';
UPDATE [dbo].[HMR_SUBMISSION_STATUS] SET LONG_DESCRIPTION = 'Indicates that an error was encountered that prevents further assessment of the submitted data, such as unexpected file type, file size, file structure, or missing a critical data field.' ,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID = @app_user,APP_LAST_UPDATE_TIMESTAMP = @utcdate,APP_LAST_UPDATE_USER_GUID = @app_guid,APP_LAST_UPDATE_USER_DIRECTORY = @app_user_dir WHERE STATUS_CODE = 'FE';
UPDATE [dbo].[HMR_SUBMISSION_STATUS] SET LONG_DESCRIPTION = 'Indicates that a file containing the exact same data was submitted in a prior upload and it will not be reprocessed. ' ,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID = @app_user,APP_LAST_UPDATE_TIMESTAMP = @utcdate,APP_LAST_UPDATE_USER_GUID = @app_guid,APP_LAST_UPDATE_USER_DIRECTORY = @app_user_dir WHERE STATUS_CODE = 'DS';
UPDATE [dbo].[HMR_SUBMISSION_STATUS] SET LONG_DESCRIPTION = 'Indicates a submitted file has been received and is being checked against expected submission requirements corresponding to the selected report type.' ,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID = @app_user,APP_LAST_UPDATE_TIMESTAMP = @utcdate,APP_LAST_UPDATE_USER_GUID = @app_guid,APP_LAST_UPDATE_USER_DIRECTORY = @app_user_dir WHERE STATUS_CODE = 'DP';
UPDATE [dbo].[HMR_SUBMISSION_STATUS] SET LONG_DESCRIPTION = 'Indicates a submitted file has been evaluated and one or more values do not meet submission requirements corresponding to the selected report type. The file will need to be uploaded again after making required corrections.' ,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID = @app_user,APP_LAST_UPDATE_TIMESTAMP = @utcdate,APP_LAST_UPDATE_USER_GUID = @app_guid,APP_LAST_UPDATE_USER_DIRECTORY = @app_user_dir WHERE STATUS_CODE = 'DE';
UPDATE [dbo].[HMR_SUBMISSION_STATUS] SET LONG_DESCRIPTION = 'Indicates a submitted file has been fully evaluated and the data meets submission requirements corresponding to the selected report type' ,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID = @app_user,APP_LAST_UPDATE_TIMESTAMP = @utcdate,APP_LAST_UPDATE_USER_GUID = @app_guid,APP_LAST_UPDATE_USER_DIRECTORY = @app_user_dir WHERE STATUS_CODE = 'VS';
UPDATE [dbo].[HMR_SUBMISSION_STATUS] SET LONG_DESCRIPTION = 'Indicates a row witin a submitted file is in the acceptable format, and does not contain critical errors that prevent further data validation.  Further validation processing can proceed.' ,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID = @app_user,APP_LAST_UPDATE_TIMESTAMP = @utcdate,APP_LAST_UPDATE_USER_GUID = @app_guid,APP_LAST_UPDATE_USER_DIRECTORY = @app_user_dir WHERE STATUS_CODE = 'RR';
UPDATE [dbo].[HMR_SUBMISSION_STATUS] SET LONG_DESCRIPTION = 'Indicates a row witin a submitted file contains the exact same data as submitted in a prior upload and it will not be reprocessed.' ,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID = @app_user,APP_LAST_UPDATE_TIMESTAMP = @utcdate,APP_LAST_UPDATE_USER_GUID = @app_guid,APP_LAST_UPDATE_USER_DIRECTORY = @app_user_dir WHERE STATUS_CODE = 'DR';
UPDATE [dbo].[HMR_SUBMISSION_STATUS] SET LONG_DESCRIPTION = 'Indicates that the row within a submitted file was received and one or more values do not meet submission requirements, corresponding to the selected report type. The record will need to be uploaded again after making required corrections.' ,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID = @app_user,APP_LAST_UPDATE_TIMESTAMP = @utcdate,APP_LAST_UPDATE_USER_GUID = @app_guid,APP_LAST_UPDATE_USER_DIRECTORY = @app_user_dir WHERE STATUS_CODE = 'RE';
UPDATE [dbo].[HMR_SUBMISSION_STATUS] SET LONG_DESCRIPTION = 'Indicates a row within a submitted file has been fully evaluated and all values meets submission requirements corresponding to the selected report type.' ,CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID = @app_user,APP_LAST_UPDATE_TIMESTAMP = @utcdate,APP_LAST_UPDATE_USER_GUID = @app_guid,APP_LAST_UPDATE_USER_DIRECTORY = @app_user_dir WHERE STATUS_CODE = 'RS';


/* ---------------------------------------------------------------------- */
/* Update or delete ACTIVITY_CODE records                        	      */
/* ---------------------------------------------------------------------- */


INSERT INTO HMR_ACTIVITY_CODE (ACTIVITY_NUMBER, ACTIVITY_NAME, UNIT_OF_MEASURE, MAINTENANCE_TYPE, LOCATION_CODE_ID, POINT_LINE_FEATURE, ACTIVITY_APPLICATION, APP_CREATE_USERID, APP_CREATE_TIMESTAMP, APP_CREATE_USER_GUID, APP_CREATE_USER_DIRECTORY, APP_LAST_UPDATE_USERID, APP_LAST_UPDATE_TIMESTAMP, APP_LAST_UPDATE_USER_GUID, APP_LAST_UPDATE_USER_DIRECTORY) VALUES ('999400', 'Routine Maintenance Services Above the RMSC (excluding Major Events)', 'dollars', 'Additional', (SELECT LOCATION_CODE_ID FROM HMR_LOCATION_CODE WHERE dbo.HMR_LOCATION_CODE.LOCATION_CODE = 'C'), 'Point', 'Province wide' , @app_user, @utcdate, @app_guid, @app_user_dir, @app_user, @utcdate, @app_guid, @app_user_dir);
INSERT INTO HMR_ACTIVITY_CODE (ACTIVITY_NUMBER, ACTIVITY_NAME, UNIT_OF_MEASURE, MAINTENANCE_TYPE, LOCATION_CODE_ID, POINT_LINE_FEATURE, ACTIVITY_APPLICATION, APP_CREATE_USERID, APP_CREATE_TIMESTAMP, APP_CREATE_USER_GUID, APP_CREATE_USER_DIRECTORY, APP_LAST_UPDATE_USERID, APP_LAST_UPDATE_TIMESTAMP, APP_LAST_UPDATE_USER_GUID, APP_LAST_UPDATE_USER_DIRECTORY) VALUES ('999401', 'Major Event Response above the RMSC', 'dollars', 'Additional', (SELECT LOCATION_CODE_ID FROM HMR_LOCATION_CODE WHERE dbo.HMR_LOCATION_CODE.LOCATION_CODE = 'C'), 'Point', 'Province wide' , @app_user, @utcdate, @app_guid, @app_user_dir, @app_user, @utcdate, @app_guid, @app_user_dir);
INSERT INTO HMR_ACTIVITY_CODE (ACTIVITY_NUMBER, ACTIVITY_NAME, UNIT_OF_MEASURE, MAINTENANCE_TYPE, LOCATION_CODE_ID, POINT_LINE_FEATURE, ACTIVITY_APPLICATION, APP_CREATE_USERID, APP_CREATE_TIMESTAMP, APP_CREATE_USER_GUID, APP_CREATE_USER_DIRECTORY, APP_LAST_UPDATE_USERID, APP_LAST_UPDATE_TIMESTAMP, APP_LAST_UPDATE_USER_GUID, APP_LAST_UPDATE_USER_DIRECTORY) VALUES ('999402', 'More Quantified', 'dollars', 'Additional', (SELECT LOCATION_CODE_ID FROM HMR_LOCATION_CODE WHERE dbo.HMR_LOCATION_CODE.LOCATION_CODE = 'C'), NULL, 'Province wide' , @app_user, @utcdate, @app_guid, @app_user_dir, @app_user, @utcdate, @app_guid, @app_user_dir);
INSERT INTO HMR_ACTIVITY_CODE (ACTIVITY_NUMBER, ACTIVITY_NAME, UNIT_OF_MEASURE, MAINTENANCE_TYPE, LOCATION_CODE_ID, POINT_LINE_FEATURE, ACTIVITY_APPLICATION, APP_CREATE_USERID, APP_CREATE_TIMESTAMP, APP_CREATE_USER_GUID, APP_CREATE_USER_DIRECTORY, APP_LAST_UPDATE_USERID, APP_LAST_UPDATE_TIMESTAMP, APP_LAST_UPDATE_USER_GUID, APP_LAST_UPDATE_USER_DIRECTORY) VALUES ('999403', 'Maintenance Services on Class 8/F Roads', 'dollars', 'Additional', (SELECT LOCATION_CODE_ID FROM HMR_LOCATION_CODE WHERE dbo.HMR_LOCATION_CODE.LOCATION_CODE = 'B'), NULL, 'Province wide' , @app_user, @utcdate, @app_guid, @app_user_dir, @app_user, @utcdate, @app_guid, @app_user_dir);
INSERT INTO HMR_ACTIVITY_CODE (ACTIVITY_NUMBER, ACTIVITY_NAME, UNIT_OF_MEASURE, MAINTENANCE_TYPE, LOCATION_CODE_ID, POINT_LINE_FEATURE, ACTIVITY_APPLICATION, APP_CREATE_USERID, APP_CREATE_TIMESTAMP, APP_CREATE_USER_GUID, APP_CREATE_USER_DIRECTORY, APP_LAST_UPDATE_USERID, APP_LAST_UPDATE_TIMESTAMP, APP_LAST_UPDATE_USER_GUID, APP_LAST_UPDATE_USER_DIRECTORY) VALUES ('999404', 'Designated First Nations Services', 'dollars', 'Additional', (SELECT LOCATION_CODE_ID FROM HMR_LOCATION_CODE WHERE dbo.HMR_LOCATION_CODE.LOCATION_CODE = 'C'), NULL, 'Province wide' , @app_user, @utcdate, @app_guid, @app_user_dir, @app_user, @utcdate, @app_guid, @app_user_dir);
INSERT INTO HMR_ACTIVITY_CODE (ACTIVITY_NUMBER, ACTIVITY_NAME, UNIT_OF_MEASURE, MAINTENANCE_TYPE, LOCATION_CODE_ID, POINT_LINE_FEATURE, ACTIVITY_APPLICATION, APP_CREATE_USERID, APP_CREATE_TIMESTAMP, APP_CREATE_USER_GUID, APP_CREATE_USER_DIRECTORY, APP_LAST_UPDATE_USERID, APP_LAST_UPDATE_TIMESTAMP, APP_LAST_UPDATE_USER_GUID, APP_LAST_UPDATE_USER_DIRECTORY) VALUES ('999405', 'Other Additional Maintenance Services', 'dollars', 'Additional', (SELECT LOCATION_CODE_ID FROM HMR_LOCATION_CODE WHERE dbo.HMR_LOCATION_CODE.LOCATION_CODE = 'B'), NULL, 'Province wide' , @app_user, @utcdate, @app_guid, @app_user_dir, @app_user, @utcdate, @app_guid, @app_user_dir);

UPDATE [dbo].[HMR_ACTIVITY_CODE]
   SET UNIT_OF_MEASURE = 'site',CONCURRENCY_CONTROL_NUMBER=CONCURRENCY_CONTROL_NUMBER+1,APP_LAST_UPDATE_USERID=@app_user,APP_LAST_UPDATE_TIMESTAMP=@utcdate,APP_LAST_UPDATE_USER_GUID=@app_guid,APP_LAST_UPDATE_USER_DIRECTORY=@app_user_dir
 WHERE UNIT_OF_MEASURE = 'site/num'
GO

DELETE FROM [dbo].[HMR_ACTIVITY_CODE] WHERE ACTIVITY_NUMBER IN (996499,997499,998499,999499)
GO

